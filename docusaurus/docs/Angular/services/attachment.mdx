---
id: attachment
sidebar_position: 1
title: Attachment service
---

The `AttachmentService` manages the uploads of a message input.

# Overview

## attachmentUploadInProgressCounter$

A stream that emits the number of uploads in progress.

## attachmentUploads$

A stream that emits the state of the uploads ([`AttachmentUpload[]`](https://github.com/GetStream/stream-chat-angular/blob/master/projects/stream-chat-angular/src/lib/types.ts)), it adds a state (`success`, `error` or `uploading`) to each file the user selects for upload. It is used by the [`AttachmentPreviewList`](../components/attachment-preview-list) to display the attachment previews.

## filesSelected

Uploads the selected files, and creates preview for image files. The result is propagated throught the `attachmentUploads$` stream.

### Params:

| Name  | Type                                                                    | Description                    | Default |
| ----- | ----------------------------------------------------------------------- | ------------------------------ | ------- |
| files | [`FileList`](https://developer.mozilla.org/en-US/docs/Web/API/FileList) | The files selected by the user | -       |

### Returns

`Promise<void>`

Please note that the `Promise` is resolved even if one or more upload is failed, you can use the `attachmentUploads$` stream to get information about the uploads.

## deleteAttachment

Deletes an attachment, the attachment can have any state (`error`, `uploading` or `success`).

### Params:

| Name   | Type                                                                                                                             | Description                       | Default |
| ------ | -------------------------------------------------------------------------------------------------------------------------------- | --------------------------------- | ------- |
| upload | [`AttachmentUpload`](https://github.com/GetStream/stream-chat-angular/blob/master/projects/stream-chat-angular/src/lib/types.ts) | The uploaded attachment to delete | -       |

### Returns

`Promise<void>`

The promise will be resolved if the delete was successful, and rejected if an error occured.

## retryAttachmentUpload

Retries to upload an attachment.

### Params:

| Name | Type   | Description             | Default |
| ---- | ------ | ----------------------- | ------- |
| file | `File` | The file to be uploaded | -       |

### Returns

`Promise<void>`

Please note that the `Promise` is resolved even if the upload is failed, you can use the `attachmentUploads$` stream to get information about the uploads.

## resetAttachmentUploads

Resets the current uploads.

### Params

None

### Returns

void

## mapToAttachments

Maps the current uploads to a format that can be sent along with the message to the Stream API.

### Params

None

### Returns

[`Attachment[]`](https://getstream.io/chat/docs/javascript/message_format/?language=javascript#attachment-format) accepted by the Stream API.

## createFromAttachments

Maps attachments received from the Stream API to uploads. This is useful when editing a message.

### Params

| Name        | Type                                                                                                              | Description                                           | Default |
| ----------- | ----------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------- | ------- |
| attachments | [`Attachment[]`](https://getstream.io/chat/docs/javascript/message_format/?language=javascript#attachment-format) | Attachments received in a message from the Stream API | -       |
